function add_bbcode(A,B,C){if(!C){C=""}textarea=document.getElementById(A);if(textarea.selection!="undefined"&&textarea.createTextRange){was_empty=textarea.selection.text.length;textarea.selection.text=textarea.selection.text.charAt(textarea.selection.text.length-1)==" "?B+textarea.selection.text+C+" ":B+textarea.selection.text+C;if(was_empty){textarea.selection.moveStart("character",-C.length);textarea.selection.moveEnd("character",-C.length);textarea.selection.select()}else{textarea.focus(textarea.selection)}}else{if(textarea.selectionStart!="undefined"){str=textarea.value.substring(0,textarea.selectionStart);str+=B;str+=textarea.value.substring(textarea.selectionStart,textarea.selectionEnd);str+=C;str+=textarea.value.substring(textarea.selectionEnd);textarea.value=str}else{textarea.value+=B+C;textarea.focus(textarea.value.length-1)}}};
